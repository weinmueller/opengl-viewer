<?xml version="1.0" encoding="UTF-8"?>
<xml>

  <!-- Computational domain -->
 <MultiPatch parDim="2" id="0">
  <patches type="id_range">500 505</patches>
  <interfaces>
    505 4 501 2 1 0 1 0
    505 2 504 2 0 1 0 1
    504 4 501 4 0 1 1 0
    505 1 502 2 0 1 1 1
    503 4 501 1 1 0 1 1
    503 2 504 1 0 1 1 1
    502 4 501 3 0 1 1 1
    503 1 502 1 0 1 0 1
    504 3 500 4 0 1 1 1
    505 3 500 2 1 0 1 1
    502 3 500 3 0 1 1 0
    503 3 500 1 1 0 1 0
</interfaces>
 </MultiPatch>

  <!-- Right-hand side function -->
  <Function type="FunctionExpr" id="1" dim="3">
    u:=atan2(y,x);
    v:=atan2(sqrt(x^2+y^2),z);
    w:=sqrt(x^2+y^2+z^2);
    t:=100;
    -(-2*cos(v)*t*(v - 1/2)*exp(-t*(v - 1/2)^2) - 2*sin(v)*t*exp(-t*(v - 1/2)^2) + 4*sin(v)*t^2*(v - 1/2)^2*exp(-t*(v - 1/2)^2))/(w^2*sin(v))
  </Function>

  <!-- The boundary conditions (multipatch=number of patches)-->
  <boundaryConditions id="2" multipatch="0">
  <!-- Corner values -->
    <cv unknown="0" patch="0" corner="0">0.0</cv>
  </boundaryConditions>

  <!-- The manufactured exact solution (for reference) -->
  <Function type="FunctionExpr" id="3" dim="3">
    u:=atan2(y,x);
    v:=atan2(sqrt(x^2+y^2),z);
    w:=sqrt(x^2+y^2+z^2);
    t:=100;
    exp(-t*(v - 1/2)^2)
  </Function>

  <!-- Assembler options -->
 <OptionList id="4">
  <int label="DirichletStrategy" desc="Method for enforcement of Dirichlet BCs [11..14]" value="11"/>
  <int label="DirichletValues" desc="Method for computation of Dirichlet DoF values [100..103]" value="101"/>
  <int label="InterfaceStrategy" desc="Method of treatment of patch interfaces [0..3]" value="1"/>
  <real label="bdA" desc="Estimated nonzeros per column of the matrix: bdA*deg + bdB" value="2"/>
  <int label="bdB" desc="Estimated nonzeros per column of the matrix: bdA*deg + bdB" value="1"/>
  <real label="bdO" desc="Overhead of sparse mem. allocation: (1+bdO)(bdA*deg + bdB) [0..1]" value="0.333"/>
  <real label="quA" desc="Number of quadrature points: quA*deg + quB" value="1"/>
  <int  label="quB" desc="Number of quadrature points: quA*deg + quB" value="1"/>
  <int label="quRule" desc="Quadrature rule [1:GaussLegendre,2:GaussLobatto]" value="1"/>
  <bool label="SameElement" desc="Activates optimization if all quadrature points are located in the same element" value="0"/>
 </OptionList>


  <!-- other options -->

  <!-- Spline data -->
 <Geometry type="TensorNurbs2" id="500">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">-0.5773502691896258 0.5773502691896258 -0.5773502691896258
-0.3128761922915927 0.7095873076386423 -0.7095873076386423
0 0.7540207849145407 -0.7540207849145407
0.3128761922915927 0.7095873076386423 -0.7095873076386423
0.5773502691896258 0.5773502691896258 -0.5773502691896258
-0.7095873076386423 0.3128761922915927 -0.7095873076386423
-0.4133641257993196 0.4133641257993196 -1
0 0.4573040804906464 -1.120046188698979
0.4133641257993196 0.4133641257993196 -1
0.7095873076386423 0.3128761922915927 -0.7095873076386423
-0.7540207849145407 0 -0.7540207849145407
-0.4573040804906464 0 -1.120046188698979
0 0 -1.279833218175124
0.4573040804906464 0 -1.120046188698979
0.7540207849145407 0 -0.7540207849145407
-0.7095873076386423 -0.3128761922915927 -0.7095873076386423
-0.4133641257993196 -0.4133641257993196 -1
0 -0.4573040804906464 -1.120046188698979
0.4133641257993196 -0.4133641257993196 -1
0.7095873076386423 -0.3128761922915927 -0.7095873076386423
-0.5773502691896258 -0.5773502691896258 -0.5773502691896258
-0.3128761922915927 -0.7095873076386423 -0.7095873076386423
0 -0.7540207849145407 -0.7540207849145407
0.3128761922915927 -0.7095873076386423 -0.7095873076386423
0.5773502691896258 -0.5773502691896258 -0.5773502691896258
</coefs>
 </Geometry>
 <Geometry type="TensorNurbs2" id="501">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">-0.5773502691896258 0.577350269189626 0.5773502691896257
-0.3128761922915927 0.7095873076386424 0.7095873076386422
0 0.7540207849145408 0.7540207849145406
0.3128761922915927 0.7095873076386424 0.7095873076386422
0.5773502691896258 0.577350269189626 0.5773502691896257
-0.7095873076386423 0.3128761922915928 0.7095873076386423
-0.4133641257993196 0.4133641257993197 1
0 0.4573040804906465 1.120046188698979
0.4133641257993196 0.4133641257993197 1
0.7095873076386423 0.3128761922915928 0.7095873076386423
-0.7540207849145407 9.234091407361672e-17 0.7540207849145407
-0.4573040804906464 1.371660979887397e-16 1.120046188698979
0 1.567343654080622e-16 1.279833218175124
0.4573040804906464 1.371660979887397e-16 1.120046188698979
0.7540207849145407 9.234091407361672e-17 0.7540207849145407
-0.7095873076386423 -0.3128761922915926 0.7095873076386423
-0.4133641257993196 -0.4133641257993195 1
0 -0.4573040804906463 1.120046188698979
0.4133641257993196 -0.4133641257993195 1
0.7095873076386423 -0.3128761922915926 0.7095873076386423
-0.5773502691896258 -0.5773502691896257 0.577350269189626
-0.3128761922915927 -0.7095873076386422 0.7095873076386424
0 -0.7540207849145406 0.7540207849145408
0.3128761922915927 -0.7095873076386422 0.7095873076386424
0.5773502691896258 -0.5773502691896257 0.577350269189626
</coefs>
 </Geometry>
 <Geometry type="TensorNurbs2" id="502">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">-0.5773502691896258 0.5773502691896258 -0.5773502691896258
-0.3128761922915927 0.7095873076386423 -0.7095873076386423
0 0.7540207849145407 -0.7540207849145407
0.3128761922915927 0.7095873076386423 -0.7095873076386423
0.5773502691896258 0.5773502691896258 -0.5773502691896258
-0.7095873076386423 0.7095873076386423 -0.3128761922915927
-0.4133641257993196 1 -0.4133641257993196
0 1.120046188698979 -0.4573040804906465
0.4133641257993196 1 -0.4133641257993196
0.7095873076386423 0.7095873076386423 -0.3128761922915927
-0.7540207849145407 0.7540207849145407 -4.617045703680836e-17
-0.4573040804906464 1.120046188698979 -6.858304899436985e-17
0 1.279833218175124 -7.836718270403109e-17
0.4573040804906464 1.120046188698979 -6.858304899436985e-17
0.7540207849145407 0.7540207849145407 -4.617045703680836e-17
-0.7095873076386423 0.7095873076386423 0.3128761922915926
-0.4133641257993196 1 0.4133641257993195
0 1.120046188698979 0.4573040804906464
0.4133641257993196 1 0.4133641257993195
0.7095873076386423 0.7095873076386423 0.3128761922915926
-0.5773502691896258 0.5773502691896258 0.5773502691896258
-0.3128761922915927 0.7095873076386423 0.7095873076386423
0 0.7540207849145407 0.7540207849145407
0.3128761922915927 0.7095873076386423 0.7095873076386423
0.5773502691896258 0.5773502691896258 0.5773502691896258
</coefs>
 </Geometry>
 <Geometry type="TensorNurbs2" id="503">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">-0.5773502691896258 0.5773502691896258 -0.5773502691896258
-0.7095873076386423 0.3128761922915927 -0.7095873076386423
-0.7540207849145407 4.617045703680836e-17 -0.7540207849145407
-0.7095873076386423 -0.3128761922915926 -0.7095873076386423
-0.5773502691896258 -0.5773502691896258 -0.5773502691896258
-0.7095873076386423 0.7095873076386423 -0.3128761922915927
-1 0.4133641257993196 -0.4133641257993196
-1.120046188698979 6.858304899436985e-17 -0.4573040804906465
-1 -0.4133641257993195 -0.4133641257993196
-0.7095873076386423 -0.7095873076386423 -0.3128761922915927
-0.7540207849145407 0.7540207849145407 -4.617045703680836e-17
-1.120046188698979 0.4573040804906465 -6.858304899436985e-17
-1.279833218175124 7.836718270403109e-17 -7.836718270403109e-17
-1.120046188698979 -0.4573040804906464 -6.858304899436985e-17
-0.7540207849145407 -0.7540207849145407 -4.617045703680836e-17
-0.7095873076386423 0.7095873076386423 0.3128761922915926
-1 0.4133641257993196 0.4133641257993195
-1.120046188698979 6.858304899436985e-17 0.4573040804906464
-1 -0.4133641257993195 0.4133641257993195
-0.7095873076386423 -0.7095873076386423 0.3128761922915926
-0.5773502691896258 0.5773502691896258 0.5773502691896258
-0.7095873076386423 0.3128761922915927 0.7095873076386423
-0.7540207849145407 4.617045703680836e-17 0.7540207849145407
-0.7095873076386423 -0.3128761922915926 0.7095873076386423
-0.5773502691896258 -0.5773502691896258 0.5773502691896258
</coefs>
 </Geometry>
 <Geometry type="TensorNurbs2" id="504">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">-0.5773502691896258 -0.5773502691896258 -0.5773502691896258
-0.3128761922915928 -0.7095873076386423 -0.7095873076386423
-9.234091407361672e-17 -0.7540207849145407 -0.7540207849145407
0.3128761922915926 -0.7095873076386423 -0.7095873076386423
0.5773502691896258 -0.5773502691896258 -0.5773502691896258
-0.7095873076386423 -0.7095873076386423 -0.3128761922915927
-0.4133641257993197 -1 -0.4133641257993196
-1.371660979887397e-16 -1.120046188698979 -0.4573040804906465
0.4133641257993195 -1 -0.4133641257993196
0.7095873076386423 -0.7095873076386423 -0.3128761922915927
-0.7540207849145407 -0.7540207849145407 -4.617045703680836e-17
-0.4573040804906465 -1.120046188698979 -6.858304899436985e-17
-1.567343654080622e-16 -1.279833218175124 -7.836718270403109e-17
0.4573040804906463 -1.120046188698979 -6.858304899436985e-17
0.7540207849145407 -0.7540207849145407 -4.617045703680836e-17
-0.7095873076386423 -0.7095873076386423 0.3128761922915926
-0.4133641257993197 -1 0.4133641257993195
-1.371660979887397e-16 -1.120046188698979 0.4573040804906464
0.4133641257993195 -1 0.4133641257993195
0.7095873076386423 -0.7095873076386423 0.3128761922915926
-0.5773502691896258 -0.5773502691896258 0.5773502691896258
-0.3128761922915928 -0.7095873076386423 0.7095873076386423
-9.234091407361672e-17 -0.7540207849145407 0.7540207849145407
0.3128761922915926 -0.7095873076386423 0.7095873076386423
0.5773502691896258 -0.5773502691896258 0.5773502691896258
</coefs>
 </Geometry>
 <Geometry type="TensorNurbs2" id="505">
  <Basis type="TensorNurbsBasis2">
   <Basis type="TensorBSplineBasis2">
    <Basis type="BSplineBasis" index="0">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
    <Basis type="BSplineBasis" index="1">
     <KnotVector degree="4">0 0 0 0 0 1 1 1 1 1 </KnotVector>
    </Basis>
   </Basis>
   <weights>5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
4.357265589908164
3.644923705673916
3.404557350153061
3.644923705673916
4.357265589908164
4.520042103603344
3.866025403784439
3.644923705673916
3.866025403784439
4.520042103603344
5.071796769724491
4.520042103603344
4.357265589908164
4.520042103603344
5.071796769724491
</weights>
  </Basis>
  <coefs geoDim="3">0.5773502691896258 0.5773502691896258 -0.5773502691896258
0.7095873076386423 0.3128761922915925 -0.7095873076386423
0.7540207849145407 -1.385113711104251e-16 -0.7540207849145407
0.7095873076386423 -0.3128761922915929 -0.7095873076386423
0.5773502691896258 -0.5773502691896258 -0.5773502691896258
0.7095873076386423 0.7095873076386423 -0.3128761922915927
1 0.4133641257993194 -0.4133641257993196
1.120046188698979 -2.057491469831095e-16 -0.4573040804906465
1 -0.4133641257993197 -0.4133641257993196
0.7095873076386423 -0.7095873076386423 -0.3128761922915927
0.7540207849145407 0.7540207849145407 -4.617045703680836e-17
1.120046188698979 0.4573040804906462 -6.858304899436985e-17
1.279833218175124 -2.351015481120933e-16 -7.836718270403109e-17
1.120046188698979 -0.4573040804906466 -6.858304899436985e-17
0.7540207849145407 -0.7540207849145407 -4.617045703680836e-17
0.7095873076386423 0.7095873076386423 0.3128761922915926
1 0.4133641257993194 0.4133641257993195
1.120046188698979 -2.057491469831095e-16 0.4573040804906464
1 -0.4133641257993197 0.4133641257993195
0.7095873076386423 -0.7095873076386423 0.3128761922915926
0.5773502691896258 0.5773502691896258 0.5773502691896258
0.7095873076386423 0.3128761922915925 0.7095873076386423
0.7540207849145407 -1.385113711104251e-16 0.7540207849145407
0.7095873076386423 -0.3128761922915929 0.7095873076386423
0.5773502691896258 -0.5773502691896258 0.5773502691896258
</coefs>
 </Geometry>
</xml>
